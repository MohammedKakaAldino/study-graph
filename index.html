<head>
  <style>
  #mynetwork {
    background-color: #2b2b2b;
  }
</style>
</head>

<body>
<div id="mynetwork" style="width:100%; height:600px;"></div>

<script src="https://unpkg.com/vis-network/standalone/umd/vis-network.min.js"></script>
<script>
fetch("https://raw.githubusercontent.com/MohammedKakaAldino/study-graph/main/database.json")
  .then(res => res.json())
  .then(database => {

    const nodes = new vis.DataSet();
    const edges = new vis.DataSet();

    for (const [node_id, node_data] of Object.entries(database)) {

      let value = 40;
      if (node_data.type === "H1") value = 100;
      else if (node_data.type === "H2") value = 80;
      else if (node_data.type === "H3") value = 60;

      const isClickable =
        (typeof node_data.url === "string" && node_data.url.trim() !== "") ||
        (Array.isArray(node_data.edges) && node_data.edges.length > 0);

      nodes.add({
        id: Number(node_id),
        label: node_data.label,
        title: node_data.title,
        value,
        url: node_data.url,
        shape: "dot",
        color: isClickable
          ? { background: "#4dabf7", border: "#1c7ed6" }
          : { background: "#adb5bd", border: "#868e96" },
        font: { color: "#ffffff" }
      });

      if (Array.isArray(node_data.edges)) {
        node_data.edges.forEach(e => edges.add({ from: Number(node_id), to: e }));
      }
    }

    const network = new vis.Network(
      document.getElementById("mynetwork"),
      { nodes, edges },
      {
        background: { color: "#2b2b2b" },
        interaction: {
          hover: true   // â­ BARIS KRITIS
        },
        nodes: {
          shape: "dot",
          scaling: { min: 10, max: 50 }
        },
        edges: {
          color: "lightgray",
          length: 120
        },
        physics: { barnesHut: {} }
      }
    );

    // CURSOR CHANGE
    network.on("hoverNode", () => {
      document.body.style.cursor = "pointer";
    });

    network.on("blurNode", () => {
      document.body.style.cursor = "default";
    });

    // CLICK TO OPEN URL
    network.on("click", params => {
      if (!params.nodes.length) return;
      const node = nodes.get(params.nodes[0]);
      if (node?.url && node.url.trim() !== "") {
        node.url.startsWith("http")
          ? window.open(node.url, "_blank")
          : window.location.href = node.url;
      }
    });

  });
</script>
</body>
